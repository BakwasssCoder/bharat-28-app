// Prisma Schema for BHARAT 28 Restaurant System
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// Admin users for the admin panel
model Admin {
  id           Int      @id @default(autoincrement())
  username     String   @unique
  passwordHash String
  role         String   @default("admin")
  lastLogin    DateTime?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// Menu categories (Litti, Paratha, Snacks, etc.)
model Category {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  menuItems MenuItem[]
}

// Individual menu items
model MenuItem {
  id          Int      @id @default(autoincrement())
  categoryId  Int
  category    Category @relation(fields: [categoryId], references: [id])
  name        String
  description String?
  price       Float
  isAvailable Boolean  @default(true)
  imageUrl    String?
  isFeatured  Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  orderItems  OrderItem[]
}

// Media assets (images, etc.)
model MediaAsset {
  id         Int      @id @default(autoincrement())
  fileUrl    String
  uploadedBy Int      // Admin ID who uploaded
  createdAt  DateTime @default(now())
}

// Site content (editable content for homepage, banners, etc.)
model SiteContent {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Orders (from counter, POS, website, etc.)
model Order {
  id          Int         @id @default(autoincrement())
  orderNumber String      @unique
  totalAmount Float
  paymentMode String
  orderSource String
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  orderItems  OrderItem[]
}

// Items within an order
model OrderItem {
  id           Int      @id @default(autoincrement())
  orderId      Int
  order        Order    @relation(fields: [orderId], references: [id])
  menuItemId   Int
  menuItem     MenuItem @relation(fields: [menuItemId], references: [id])
  quantity     Int
  priceAtSale  Float
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

// Daily sales snapshots for analytics
model DailySalesSnapshot {
  id           Int      @id @default(autoincrement())
  date         DateTime @unique
  totalOrders  Int
  totalRevenue Float
  createdAt    DateTime @default(now())
}